## RSA common modulus attack
p = 105571347803962597212142030143885897468480530173546475119573507765551969787077262390258158591764537548429465800846343024530227388964583987276484606133724398399568752451796549664819457808763989105893832005842771051814369287365724600006642352171952094837362736259769851061417241588596217419943396277107280226673
q = 143494083836568017759047981489099984548509476775403624328406737643051654439609924783739750062503021431472510877382272398963566424569748136232393129649487679227119783520785823805020264918738986897231501280736695544008963914342704284206575948290885043105971086658984086572410611801532790871128313314103622743969
e1 = 42083779332676427966910416029044503249234002404965102741581811832976386239739752688618348689266907937020722507925993471671212409478550018268287146888515772274767144739247710550528569017436006558446385365611367717288424091251150568558691582242912433884704418366690058623121582246236808723934969735494657796740
e2 = 11465772377570286694382246816625476738201200795845267261135511809373391783382720982089757634759313680052052867282044008357454317160195869712056220352524523802383088274413062061999321668276377576527384627925749615511701316226042827607865806048634294551342785755932989749422052336873581883045465471857908425773
c1 = 11457241430162538816368963012260754361346364396399801307514487573430399375642455091247949309203078555830186753119889414387221332411372451126304186673124104825604709274929238536212945553750655070221564228263029459651539219588457953228491226925179865482194692891289626478948796495824091818678199854918096294503647618085622652858388749289538238601682919988224538259121373041392448683081708210223366360660456815071575174272385315755942473563437132583983236433354897593005645876387898849729949820144258377883721726621492170622186633754267576414149848827456563145138916757291952210502906873456362167104433821957397328913779
c2 = 2491698195713467900888976875413060247946636323137897176482583785896008595897051703765939001785290077584805295070483628879834609095502702508302884558824130206058331703208888814704151923728463743126735411503024803375943986809688212560962973952710343551561868158566065312941039381127856820593251128028531959811362750117813060695530230905662964337427400997099893733932383331656244836128611743442210742883839953648922870468253648969044231994191535430057817300418244359707986876314907598737571211744059355078366506850944474674925114588009730178583732653213488960245910218885542087284313608449454393060665808100702301106447
# N = p * q
N =  15148863832521289817766690226868189186772547845519481585341691263157792819729209667006815431699227957283612974727566891416159625403011562033053093332518613305793253211249445403989676278180194766531833036751939027666176524019577113830195122537532493982209245685276167485606828194600673901603680990781890626948726957270040064996664657131638607011131541255381856651672255519400211233839572219851036937871433763510377075989765205764985157234437686967460875116531175739560269439042262452967074113160571783613051518454503028267017930949627862088376078665516948197430832869594652796654825497042734868489079299196472563685137

# #1
# egcd(e1, e2) = 1
# https://planetcalc.com/3298/
h = -2361738994214322766493858453668739816410703021797758659665448560641695165541104067950787140741637478269346830870955679515541170466201417773331239934761163865408035475379176327402913270685806665370140929372545018245107097734112766297798481356711353751701974816931684986145771241319325839940275201645850189466
k = 8668487337872188715958777877975394473468194408018729048944122718957166045493937425461236495082296776355059913480332269224178509307639111986651599726370524546747914341335159045699404878220271035749171644684237502835559844972653322357964270563273101512614393740191203057829105963122954721457393870726573759917
# #2
# verify #1
print("=========")
print(e1*h + e2*k)
# #3
# get M1 = c1 ** h % N
# get M2 = c1 ** k % N
c11 = pow(c1, h, N)
print("=========")
print(c11)
c22 = pow(c2, k, N)
print("=========")
print(c22)
# #4
# get M = M1 * M2 % N
m =  (c11*c22) % N
print("=========")
print(m)


n1 = 31107905242634268647858397739063361406554692462300088765190191676055371802040583622551920343363714166892797565064228764923072709271010887990232401522313937238964658809149042134701101777114348751876637056905429933140094682368820857269519410183452414933031552300982705439629210640509807066251272215653283027074338847148022419041069103240175341801486947808814501038319011257764817035408181171289934835892686878882279784804009903759582130967716553432343371657746467645515199963129979192565841605192329482059537014746833061723475509977504430156144148092691050093833298275815325200684100572852097354318180853614599077138871
e1 = 37874040582520839245615738655023773723742586654303682003140810849858976583582741682087742931823150319527753335219254363537529502053892296044485578972189109348792056127416963254916453575296622108186745975607331567770213197168178712514744831895069229169748490802673699484849586342317169386525983263744712779809
n2 = 31107905242634268647858397739063361406554692462300088765190191676055371802040583622551920343363714166892797565064228764923072709271010887990232401522313937238964658809149042134701101777114348751876637056905429933140094682368820857269519410183452414933031552300982705439629210640509807066251272215653283027074338847148022419041069103240175341801486947808814501038319011257764817035408181171289934835892686878882279784804009903759582130967716553432343371657746467645515199963129979192565841605192329482059537014746833061723475509977504430156144148092691050093833298275815325200684100572852097354318180853614599077138871
e2 = 15107286215979057526753266508244351367953693470693628035785187255937935708804313272393208057847156472930241632326746730049251882687922778695188587592842422545091681900597847269067106609324966759988123627723447605968546165120009090612219305292395966620176043964482979645268658963746525187335195349569075507817
C1 = 19720334536971301647276262443464067906512383122414642334557403679755194806947489981232461451593792698687064782055183922976049203092983049818957711990579114613138784197827884749633555449697918705177470506115637059862571290958554576036128996828452450722998271926032779239557455665779126457985201441949004265283484833088284606226014533909619405249796764933349299773372046253350396499641473327808150938013733633367003143795532849228544010417725849497284430389250312234712865398024832968253429348425782841981317674161487416234666458208310549087298101865256465908628529768743358979474614100260937295489533480876464746912636
C2 = 26261406894951967253943334066037504022850309845239456709578501297145428603562679448792549462548245479771843729930374207416154398092285864149637650299197599487821247936452521417264042453689654137041354742119673157160121445965713896952304036516227670451378925720445926706591491056487406306183636163283157729598009548817915539661614826477098709596362617423250702125624518158127713909102105143298133512816186339160348396610647852055851114447721207957486891257980473135747013798845812572237529273288937662316739405324174465699909041651667360331308224675855469594084812182315946205249923697575971867402946831310950534170372

h=1938128715638185002224492761432488339155564834048169811831774294547121930665469582250131623392926016806742658798502864405897442277908599790935835447209255799742821904759676488039632938963001760417087791992293614480765308892319694011450301407176665612068756220802063582538974839917649545623936993149328328833
k=-4858898188649460856058079532437944049619399666170227019624851898418937717125926865838271338416310938117389662572572978868328562466831477747046581304730153701548276997530122019382703154722228274900242904549977081631062239195253702971023948744662173305173126148998669115586649605008822584922329684426667485088

c11 = pow(c1, h, n1)
print("=========")
print(c11)
c22 = pow(c2, k, n1)
print("=========")
print(c22)
# #4
# get M = M1 * M2 % N
m =  (c11*c22) % n1
print("=========")
print(m)

#7801065




