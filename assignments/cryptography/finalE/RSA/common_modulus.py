from libnum import *


def common_modulus(e1, e2, c1, c2, N):
    # Extended Euclidean algorithm
    a, b, d = xgcd(e1, e2)

    # Invert negative factor
    if b < 0:
        c2 = invmod(c2, N)
        b = -b
    if a < 0:
        c1 = invmod(c1, N)
        a = -a

    # Get the message (c1^a * c2^b) % N
    m = (pow(c1, a, N) * pow(c2, b, N)) % N
    return [m, a, b, d]


def pad(m, d, i, N):
    if -d * 4 * i < 0:
        f = pow(invmod(2, N), d * 4 * i, N)
    else:
        f = pow(2, -d * 4 * i, N)
    return m * f % N


## Common Modulus 1
# N = 11499263563999583967509480330063845639646050588726239035454169476322646875703990669734741078564593797130966638175710877585594212680456809769414248216782698618986288767252477135593354272687282579095826295546835930196653430297357004517651185176089734422800365199013911881496733352798810442360099845513095517031572595362424599841703584618962199972524977467658497629478654674201256724701739768410647199592635970216932858409713174931366210711458881252057032951555835816184314146708097767253299728162816454108071573266367450352410947700501670202350197364602810842223691539898151639004239116907899232415843874790477348332067
# e1 = 17619709724500793622766355536893728913407364476377334983367472524003700553500434661848816516606894827618718251725392283866011559622580723433192314669048899896594077574414233483838125612059595291343595586068607805163583456908738104785349199176422390309137155938377924540128046528384497212140981844955339093115
# c1 = 691094641928563459795005043967453581182835685823495019798465918166501811006074553862182985408837765080844874551503942503074666148493407512345399250718022152341059007689784264959043230385535964877525948888157551197762821717577475594336650593555049229793630922214834996172421665657913405152589799756311574389436040922223104354752545715274071343440036023677328857748314797959372392908937924373936462826373828253254322965196515208009626561456630787273073083880172224443253736179208867808098740101571170767193266206166410808474614035979971600522346489479460150700501675028908822064720882332448398881179524061122684472369
# e2 = 126460394123838592921533118255375730269263040804189514796484873156578734522076689744784253195385753771294248776394094362374371863790775213908713782656059609250234371884626756179685030541361650827551185870216052957925520119962094320106500790722496556827045124183960010734059331490482163916967931724068485579562
# c2 = 5116043490391054819427713355027548334752704874354140406825522681001208075786595443287585379415469892939751326230577118178125176516308225488911799585005088421868333809273198520515380834578374147182404258553452908716345235682610181145624079815625491201256547604447136756250205018625779208033921709584434451041109037852514732827088383061615733156182672185574090279583906037793679211478202815064982583643403959413638066471094637860341992835861394774038716929204949824060348058363210663996983901308729557521593691609698191229483000919377741124619631447488411755482981191751947093605537064628463981828501637736450016092359

# m, a, b, d = common_modulus(e1, e2, c1, c2, N)
# flag = n2s(m)
# print(m)
# print(a)
# print(b)
# print(d)
# print(flag)


# print("===========================")
# ## Common Modulus 2
# N = 11499263563999583967509480330063845639646050588726239035454169476322646875703990669734741078564593797130966638175710877585594212680456809769414248216782698618986288767252477135593354272687282579095826295546835930196653430297357004517651185176089734422800365199013911881496733352798810442360099845513095517031572595362424599841703584618962199972524977467658497629478654674201256724701739768410647199592635970216932858409713174931366210711458881252057032951555835816184314146708097767253299728162816454108071573266367450352410947700501670202350197364602810842223691539898151639004239116907899232415843874790477348332067
# e1 = 17619709724500793622766355536893728913407364476377334983367472524003700553500434661848816516606894827618718251725392283866011559622580723433192314669048899896594077574414233483838125612059595291343595586068607805163583456908738104785349199176422390309137155938377924540128046528384497212140981844955339093115
# c1 = 691094641928563459795005043967453581182835685823495019798465918166501811006074553862182985408837765080844874551503942503074666148493407512345399250718022152341059007689784264959043230385535964877525948888157551197762821717577475594336650593555049229793630922214834996172421665657913405152589799756311574389436040922223104354752545715274071343440036023677328857748314797959372392908937924373936462826373828253254322965196515208009626561456630787273073083880172224443253736179208867808098740101571170767193266206166410808474614035979971600522346489479460150700501675028908822064720882332448398881179524061122684472369
# e2 = 126460394123838592921533118255375730269263040804189514796484873156578734522076689744784253195385753771294248776394094362374371863790775213908713782656059609250234371884626756179685030541361650827551185870216052957925520119962094320106500790722496556827045124183960010734059331490482163916967931724068485579562
# c2 = 691094641928563459795005043967453581182835685823495019798465918166501811006074553862182985408837765080844874551503942503074666148493407512345399250718022152341059007689784264959043230385535964877525948888157551197762821717577475594336650593555049229793630922214834996172421665657913405152589799756311574389436040922223104354752545715274071343440036023677328857748314797959372392908937924373936462826373828253254322965196515208009626561456630787273073083880172224443253736179208867808098740101571170767193266206166410808474614035979971600522346489479460150700501675028908822064720882332448398881179524061122684472369

# # m, a, b, d = common_modulus(e1, e2, c1, c2, N)
# # m3 = nroot(m, d)
# # flag = n2s(m3)
# # print(m3)
# # print(a)
# # print(b)
# # print(d)
# # print(flag)

# print("===========================")

# ## Common Modulus 3
# p = 105571347803962597212142030143885897468480530173546475119573507765551969787077262390258158591764537548429465800846343024530227388964583987276484606133724398399568752451796549664819457808763989105893832005842771051814369287365724600006642352171952094837362736259769851061417241588596217419943396277107280226673
# q = 143494083836568017759047981489099984548509476775403624328406737643051654439609924783739750062503021431472510877382272398963566424569748136232393129649487679227119783520785823805020264918738986897231501280736695544008963914342704284206575948290885043105971086658984086572410611801532790871128313314103622743969
# N = p*q
# e1 = 42083779332676427966910416029044503249234002404965102741581811832976386239739752688618348689266907937020722507925993471671212409478550018268287146888515772274767144739247710550528569017436006558446385365611367717288424091251150568558691582242912433884704418366690058623121582246236808723934969735494657796740
# e2 = 11465772377570286694382246816625476738201200795845267261135511809373391783382720982089757634759313680052052867282044008357454317160195869712056220352524523802383088274413062061999321668276377576527384627925749615511701316226042827607865806048634294551342785755932989749422052336873581883045465471857908425773
# c1 = 11457241430162538816368963012260754361346364396399801307514487573430399375642455091247949309203078555830186753119889414387221332411372451126304186673124104825604709274929238536212945553750655070221564228263029459651539219588457953228491226925179865482194692891289626478948796495824091818678199854918096294503647618085622652858388749289538238601682919988224538259121373041392448683081708210223366360660456815071575174272385315755942473563437132583983236433354897593005645876387898849729949820144258377883721726621492170622186633754267576414149848827456563145138916757291952210502906873456362167104433821957397328913779
# c2 = 2491698195713467900888976875413060247946636323137897176482583785896008595897051703765939001785290077584805295070483628879834609095502702508302884558824130206058331703208888814704151923728463743126735411503024803375943986809688212560962973952710343551561868158566065312941039381127856820593251128028531959811362750117813060695530230905662964337427400997099893733932383331656244836128611743442210742883839953648922870468253648969044231994191535430057817300418244359707986876314907598737571211744059355078366506850944474674925114588009730178583732653213488960245910218885542087284313608449454393060665808100702301106447


# m, a, b, d = common_modulus(e1, e2, c1, c2, N)
# m4 = nroot(m, d)
# flag = n2s(m4)
# print(m4)
# print(a)
# print(b)
# print(d)
# print(flag)

# for i in range(1900, 2048):
#     m_unpadded = pad(m, d, i, N)
#     m17 = nroot(m_unpadded, d)
#     flag = n2s(m17)
#     if 'CTF{' in flag:
#         print(flag)
#         break


n1 = 31107905242634268647858397739063361406554692462300088765190191676055371802040583622551920343363714166892797565064228764923072709271010887990232401522313937238964658809149042134701101777114348751876637056905429933140094682368820857269519410183452414933031552300982705439629210640509807066251272215653283027074338847148022419041069103240175341801486947808814501038319011257764817035408181171289934835892686878882279784804009903759582130967716553432343371657746467645515199963129979192565841605192329482059537014746833061723475509977504430156144148092691050093833298275815325200684100572852097354318180853614599077138871
e1 = 37874040582520839245615738655023773723742586654303682003140810849858976583582741682087742931823150319527753335219254363537529502053892296044485578972189109348792056127416963254916453575296622108186745975607331567770213197168178712514744831895069229169748490802673699484849586342317169386525983263744712779809
n2 = 31107905242634268647858397739063361406554692462300088765190191676055371802040583622551920343363714166892797565064228764923072709271010887990232401522313937238964658809149042134701101777114348751876637056905429933140094682368820857269519410183452414933031552300982705439629210640509807066251272215653283027074338847148022419041069103240175341801486947808814501038319011257764817035408181171289934835892686878882279784804009903759582130967716553432343371657746467645515199963129979192565841605192329482059537014746833061723475509977504430156144148092691050093833298275815325200684100572852097354318180853614599077138871
e2 = 15107286215979057526753266508244351367953693470693628035785187255937935708804313272393208057847156472930241632326746730049251882687922778695188587592842422545091681900597847269067106609324966759988123627723447605968546165120009090612219305292395966620176043964482979645268658963746525187335195349569075507817
C1 = 19720334536971301647276262443464067906512383122414642334557403679755194806947489981232461451593792698687064782055183922976049203092983049818957711990579114613138784197827884749633555449697918705177470506115637059862571290958554576036128996828452450722998271926032779239557455665779126457985201441949004265283484833088284606226014533909619405249796764933349299773372046253350396499641473327808150938013733633367003143795532849228544010417725849497284430389250312234712865398024832968253429348425782841981317674161487416234666458208310549087298101865256465908628529768743358979474614100260937295489533480876464746912636
C2 = 26261406894951967253943334066037504022850309845239456709578501297145428603562679448792549462548245479771843729930374207416154398092285864149637650299197599487821247936452521417264042453689654137041354742119673157160121445965713896952304036516227670451378925720445926706591491056487406306183636163283157729598009548817915539661614826477098709596362617423250702125624518158127713909102105143298133512816186339160348396610647852055851114447721207957486891257980473135747013798845812572237529273288937662316739405324174465699909041651667360331308224675855469594084812182315946205249923697575971867402946831310950534170372

print("===========================")
m, a, b, d = common_modulus(e1, e2, C1, C2, n1)
m4 = nroot(m, d)
flag = n2s(m4)
print(m4)